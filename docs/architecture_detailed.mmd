graph TB
    subgraph "ç”¨æˆ·äº¤äº’å±‚"
        USER[ğŸ‘¤ ç”¨æˆ·]
        CLI[ğŸ’» CLIå‘½ä»¤è¡Œ]
        TG[ğŸ“± Telegram]
        WA[ğŸ’¬ WhatsApp]
    end
    
    subgraph "æ¶ˆæ¯æ€»çº¿å±‚"
        INBOUND[ğŸ“¥ å…¥ç«™é˜Ÿåˆ—]
        OUTBOUND[ğŸ“¤ å‡ºç«™é˜Ÿåˆ—]
    end
    
    subgraph "Agentæ ¸å¿ƒå±‚"
        LOOP[ğŸ”„ Agentå¾ªç¯]
        CONTEXT[ğŸ“ ä¸Šä¸‹æ–‡æ„å»º]
        TOOLS[ğŸ› ï¸ å·¥å…·æ³¨å†Œè¡¨]
        SUBAGENT[âš¡ å­Agentç®¡ç†]
    end
    
    subgraph "LLMå±‚"
        LLM[ğŸ§  LLMæä¾›å•†<br/>Claude / GPT / Gemini]
    end
    
    subgraph "å·¥å…·å±‚"
        FILE[ğŸ“ æ–‡ä»¶æ“ä½œ]
        SHELL[âš™ï¸ Shellæ‰§è¡Œ]
        WEB[ğŸŒ Webæœç´¢]
        MSG[ğŸ’¬ æ¶ˆæ¯å‘é€]
    end
    
    %% ç”¨æˆ·è¾“å…¥æµ
    USER --> CLI
    USER --> TG
    USER --> WA
    CLI --> INBOUND
    TG --> INBOUND
    WA --> INBOUND
    
    %% Agentå¤„ç†æµ
    INBOUND --> LOOP
    LOOP --> CONTEXT
    CONTEXT --> LLM
    LLM --> LOOP
    LOOP --> TOOLS
    LOOP --> SUBAGENT
    
    %% å·¥å…·æ‰§è¡Œ
    TOOLS --> FILE
    TOOLS --> SHELL
    TOOLS --> WEB
    TOOLS --> MSG
    
    %% å“åº”è¾“å‡ºæµ
    LOOP --> OUTBOUND
    OUTBOUND --> CLI
    OUTBOUND --> TG
    OUTBOUND --> WA
    CLI --> USER
    TG --> USER
    WA --> USER
    
    %% æ ·å¼
    classDef userLayer fill:#E3F2FD,stroke:#1976D2,stroke-width:2px
    classDef busLayer fill:#FFF9C4,stroke:#F57F17,stroke-width:2px
    classDef agentLayer fill:#E8F5E9,stroke:#388E3C,stroke-width:2px
    classDef llmLayer fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px
    classDef toolLayer fill:#FFE0B2,stroke:#E65100,stroke-width:2px
    
    class USER,CLI,TG,WA userLayer
    class INBOUND,OUTBOUND busLayer
    class LOOP,CONTEXT,TOOLS,SUBAGENT agentLayer
    class LLM llmLayer
    class FILE,SHELL,WEB,MSG toolLayer
